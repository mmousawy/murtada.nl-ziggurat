.page-section:not(.page-section--inverted) .content-row {
  &:nth-of-type(odd) {
    @include bp(min-small) {
      background-color: lighten(get('colors.primary'), 30%);
    }
  }
}

.content-row .wrap {
  display: flex;

  @include bp(min-small) {
    padding: calc(1rem + 2vw) 1rem;
  }

  @include bp(max-small) {
    padding-top: 0;

    > .content-row__text {
      z-index: 2;
      order: 1;
    }
  }

  .button {
    display: inline-block;
    font-size: 1.35rem;
    z-index: 2;

    @include bp(max-small) {
      font-size: 1.15rem;
    }
  }

  @include bp(max-small) {
    flex-direction: column;
  }
}

.content-row .wrap--vertical {
  display: flex;
  flex-direction: column;
}

.content-row__text,
.content-row__transparent {
  h2:first-child {
    text-align: left;
    margin: 0;
    max-width: unset;
  }

  &--centered {
    width: 100%;
    display: flex;
    max-width: unset;
    align-items: center;
    justify-content: center;
  }

  &--column {
    flex-direction: column;
  }

  .content-row--end & {
    margin-top: 0;

    @include bp(max-small) {
      padding-bottom: 1rem;
    }
  }
}

.content-row__text {
  align-self: center;
  width: 100%;
  max-width: 49rem;
  margin-top: 0;
  margin-bottom: 0;
  font-size: 1.315rem;
  line-height: 1.5;
  color: lighten(get('colors.text.body'), 10%);

  h3 {
    font-size: get('fonts.heading.size-h2');
    margin: 0;

    @include bp(max-small) {
      font-size: get('fonts.heading.size-h2') * .75;
    }
  }

  p {
    &:last-child {
      margin-bottom: 0;
    }
  }

  &--top {
    align-self: flex-start;
  }

  &--title {
    max-width: 30%;
  }

  @include bp(max-small) {
    max-width: 100%;
    margin: {
      left: auto;
      right: auto;
    }
    padding: 4vw 0 5vw;
    font-size: 1.125rem;

    &--title {
      padding: 0;
    }

    @at-root .page-section:not(.page-section--inverted) & {
      background-color: get('colors.white');
    }

    @at-root .page-section.page-section--inverted & {
      background-color: desaturate(darken(get('colors.primary'), 50%), 50%);
    }

    + picture {
      order: 0;
    }
  }
}

.picture-wrapper {
  margin: 0;
  position: relative;
  display: block;
  float: left;
  width: 100%;
  // background: desaturate(lighten(get('colors.primary'), 20%), 40%);

  .content-row__text & {
    padding: 2vw 0 calc(2vw + 1em);
  }

  &--small {
    max-width: 40%;
  }

  &--large {
    max-width: 66%;
  }

  picture {
    display: block;
    opacity: 1;
    transform: translateY(0);
    transition: {
      property: transform, opacity;
      duration: 400ms;
    };

    &.lazy {
      transform: translateY(1rem);
      opacity: 0;
    }
  }

  img,
  source {
    position: absolute;
    top: 0;
    left: 0;
  }

  &--highlight {
    margin-bottom: 2rem;
  }

  @include bp(max-small) {
    + .content-row__text {
      padding: 4vw 5vw 5vw;
      margin-top: -4rem;
      border-radius: .25rem;
      box-shadow: 0 .5rem 2rem -1rem transparentize(mix(get('colors.primary'), get('colors.black'), 75%), .6);
    }
  }
}

.picture-wrapper__caption {
  padding-left: 2rem;
  margin: 2vw 2vw 0;
  color: #4d4b4a;
  font-family: Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif;
  font-style: italic;
  font-size: .875em;
  background: {
    repeat: no-repeat;
    size: 1.5em;
    position: -2px 0;
    image: url('inline:assets/images/figcaption-icon.svg?fill=#{lighten(#4d4b4a, 10%)}');
  }
}

.align-left {
  @include bp(min-small) {
    + .content-row__text {
      margin-left: calc(1rem + 2vw);
    }
  }
}

.align-right {
  order: 1;

  @include bp(min-small) {
    + .content-row__text {
      margin-right: calc(1rem + 2vw);
    }
  }
}

.align-left,
.align-right {
  @include bp(max-small) {
    width: 100vw;
    max-width: 100vw;
    margin: {
      left: -1rem;
      right: 0;
    }
  }
}

.highlight-text {
  font-size: 1.5rem;
  margin-bottom: 3rem;

  @include bp(max-small) {
    font-size: 1.25rem;
  }
}

$gallery-padding: 3vw;

.gallery {
  position: relative;
  border-bottom: 2px solid #363842;
  background-color: #363842;
}

.gallery__overlay {
  position: absolute;
  z-index: 3;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(100% - 1rem);
  pointer-events: none;

  .gradient {
    content: '';
    display: block;
    position: absolute;
    top: 0;
    width: $gallery-padding;
    height: 100%;
    @include scrimGradient(#363842, '90deg');

    &--left {
      left: 0;
    }

    &--right {
      right: 0;
      transform: rotate(180deg);
    }

    @include bp(max-small) {
      width: 2 * $gallery-padding;
    }
  }
}

.gallery__pane {
  position: relative;
  overflow-y: hidden;
  overflow-x: scroll;
  display: flex;
  flex-flow: row;
  height: 50vh;
  padding: $gallery-padding 0 $gallery-padding $gallery-padding;

  &.snap {
    scroll-snap-points-x: repeat(300px);
    scroll-snap-type: mandatory;
    scroll-snap-type: both mandatory;
    scroll-padding: 1rem;
  }

  &::-webkit-scrollbar-track {
    border-radius: 10px;
  }

  &::-webkit-scrollbar {
    width: 12px;
    background-color: lighten(#363842, 10%);
  }

  &::-webkit-scrollbar-thumb {
    border-radius: 10px;
    background-color: lighten(#363842, 60%);
  }

  @include bp(max-small) {
    height: 40vh;
    padding: $gallery-padding $gallery-padding * 2;
  }
}

.gallery__picture {
  height: 100%;
  flex-shrink: 0;
  opacity: 1;
  padding-right: $gallery-padding;
  transition: transform 200ms, opacity 200ms;

  // box-shadow: 0 0 20rem 5rem #565e8f;

  &.active {
    opacity: 1;
    transform: scale(1);
    z-index: 2;
  }

  img {
    width: auto;
    height: 100%;
    display: block;
    scroll-snap-align: center;

    @include bp(max-small) {
      width: calc(100% - #{4 * $gallery-padding});
      height: 100%;
      object-fit: contain;
    }
  }

  @include bp(max-small) {
    transform: scale(.95);
    opacity: .15;
  }
}
